Se optimiza de manera conjunta el control y dimensionamiento de un sistema
energético para una vivienda equipada con bomba de calor, paneles fotovoltaicos
y almacenamiento en forma de baterías y tanque de agua.

Para un año completo se determinan las señales de control y las dimensiones
óptimas de los equipos (potencia de la bomba de calor, capacidad instalada de
paneles solares, potencia máxima contratada con la comercializadora, capacidad
de la batería y volumen del tanque de agua) que minimizan el coste total,
manteniendo la temperatura de la vivienda en torno a los 20°C.

El problema resultante es de gran escala, con cientos de miles de variables de
diseño, por lo que necesitamos obtener las derivadas de forma eficiente y
utilizar matrices dispersas para la representar las jacobianas.

El sistema se modela como un conjunto de ecuaciones diferenciales algebraicas y
sus derivadas se obtienen mediante el método de gradientes adjuntos discretos,
implementado en Python.

Además se optimiza y analiza simultáneamente este problema a través de la
técnica SAND (Simultaneous Analysis and Design), también conocida como
'all-at-once', comparando ambos enfoques.

Para las funciones objetivo, se evalúa la vivienda bajo tres escenarios:

\begin{itemize}
	\item Modalidad de autoconsumo con compensación simplificada, donde el término
	      variable en la factura de electricidad no puede ser negativo, limitando así la
	      compensación económica por el excedente de electricidad vertida a la red.
	\item Conexión a la red, vendiendo excedentes de energía al precio de mercado.
	\item Funcionamiento off-grid (desconectada de la red eléctrica).
\end{itemize}
\begin{flushleft}
	\textbf{Palabras clave:} optimización, derivadas adjuntas, diferenciación
	automática, control óptimo, eficiencia energética.
\end{flushleft}
